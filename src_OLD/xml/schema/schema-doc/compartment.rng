<?xml version="1.0" encoding="UTF-8"?>
<grammar-doc xmlns="http://relaxng.org/ns/structure/1.0" xmlns:rng="http://relaxng.org/ns/structure/1.0"><include href="cst.rng"></include><include href="cml.rng"></include><include href="clx.rng"></include><include href="cdm.rng"></include><include href="cft.rng"></include><define combine="choice" name="reaction-gens-content"><empty></empty></define><define combine="choice" name="explicit-species-content"><empty></empty></define><define combine="choice" name="species-streams-content"><empty></empty></define><define name="unit-model-content"><!--These are arranged explicitly, unlike some of the other matter that can be contributed by the different units.  There isn't any particular reason for this, except to give some overall structure.--><ref name="mol-model-content"></ref><ref name="plex-model-content"></ref></define><define name="optional-user-doc"><optional><element name="user-doc"><doc>Use this optional element to add documentation intended to appear in the html translation of the model.  The text of this element will simply appear as a paragraph in the html translation of the model.  Optionally, a link to external documentation can also appear in the html translation of the model.</doc><optional><attribute name="anchor-name"><doc>Use this attribute to specify an anchor name that can be used to target a particular reaction, species, etc. in the html translation of the model.</doc></attribute></optional><optional><attribute name="anchor-href"><doc>Use this attribute to specify a URL for external documentation (e.g. to the wiki).  This URL will be used as the target of link in html documentation generated from this model by XSLT transformation.</doc></attribute></optional><text></text></element></optional></define><start><element name="compartment-model"><doc more-doc-href="cptzr.html">This is the top-level node in documentation of the input file format for cptzr, the compartmenal version of Moleculizer.  The top-level structure of this file is nearly the same as that of Moleculier, except for adding a section for cptzr-specific run parameters, which control aspects of its approximate stochastic algorithm's behavior that are not pertinent in Moleculizer.</doc><ref name="optional-user-doc"></ref><element name="model"><doc>The model section is where almost all the biology goes, including all species and reactions that you define.  But rather than species or reactions, most of what actually goes here is really reaction generators and building-blocks for species.  For example, the typical way you enter information about a monomeric protein is as a building block for protein complexes.  Similarly, the typical way you enter a binding rate between two proteins is in a generator for dimerization and decomposition reactions between complexes that contain the two proteins.</doc><ref name="unit-model-content"></ref><element name="compartment-graph"><doc>This element describes the compartment structure of the simulation, describing the compartments and the connections, or boundaries betwen them.</doc><element name="compartments"><doc>Here, each compartment gets an element that gives it a name and tells its volume.</doc><oneOrMore><element name="compartment"><doc>Here, you give the compartment's name and volume.</doc><attribute name="name"><doc>The compartments must all have distinct names.</doc></attribute><attribute name="volume"><doc>Give the volume of the compartment in liters.</doc></attribute><ref name="optional-user-doc"></ref></element></oneOrMore></element><element name="boundaries"><doc>Compartments are connected by boundaries, which are the channels by which molecules diffuse from one compartment to another.  The rate of diffusion of a particular species across the boundary between two compartments is determined by the species's diffusion rate together with the size of the boundary.</doc><zeroOrMore><element name="boundary"><doc>Each boundary connects two compartments, its 'left' and 'right' compartments.  The size of the boundary is given (redundantly) using two parameters, area and thickness.  I understand these diffusion parameters by imagining the compartments to be separated by a semi-permeable membrane with the given area and thickness.  The diffusion-relevant 'size' is just the area divided by the thickness.</doc><attribute name="left-compartment"><doc>Give the name of one of the compartments connected by (on 'either side of') this boundary.</doc></attribute><attribute name="right-compartment"><doc>Give the name of one of the compartments connected by (on 'either side of') this boundary.</doc></attribute><attribute name="area"><doc>Give the area of the boundary between the compartments in square meters.  (Actually, only the ratio of area to thickness is important.)</doc></attribute><attribute name="thickness"><doc>Give the thickness of the boundary between the compartments in meters.  (Actually, only the ratio of area to thickness is important.)</doc></attribute><ref name="optional-user-doc"></ref></element></zeroOrMore></element></element><element name="reaction-gens"><doc>Reaction generators are defined in this section.  A reaction generator "listens" for the creation of new species that have features that the reaction generator is interested in; that is, features that make the new species a possible substrate for a reaction that the generator might make.  For example, a decomposition generator "listens" for new species containing a specific binding.  The decomposition generator knows about the rate of decomposition of this binding, which it usually assumes to be independent of the rest of the complex.  When it hears of such a new species, it creates a new decomposition reaction that breaks down the binding, potentially producing one or two new species. If a product species is new, then this whole "listening" thing happens when the reaction happens for the first time.</doc><zeroOrMore><ref name="reaction-gens-content"></ref></zeroOrMore></element><element name="explicit-species"><doc>Here you describe species explicitly because you want to create molecules of the species at some point during the simulation, because you want to track the population of the species through the simulation, or because you want to define explict reactions involving the species.  Some things that you might think would be explicit species, such as a monomeric protein, may not be; rather, they are constituents of species of complexes.  (The monomeric protein is a "mol" but you can define an explicit plex-species that contains just the one mol.)</doc><zeroOrMore><ref name="explicit-species-content"></ref></zeroOrMore></element><element name="explicit-reactions"><doc>Most of the reactions that Moleculizer works with are generated automatically by reaction generators, but you can enter reactions one-at-a-time, too.  The participants in an explicit reaction have to be explicit species, so that they have names and you therefore have a way to refer to them in the explicit reaction's definition.</doc><zeroOrMore><element name="reaction"><doc>This is for defining an explicit reaction in stoichiometric, or "high-school-chemistry" format, by giving the names of (explicit) substrate species, along with their multiplicities, and similarly giving the names of (explicit) product species, along with their multiplicities.  Finally, you give the reaction rate.  Note that there is no enforcement of conservation of mass or any other such sanity checks.  Every reaction should have at least one substrate.</doc><ref name="optional-user-doc"></ref><zeroOrMore><element name="reactant-global-species-ref"><doc>Here, you give the name of a reactant species, along with its multiplicity as a reactant (how many molecules are consumed by each reaction event).</doc><attribute name="name"><doc>Give the name of an explicit species.</doc></attribute><attribute name="multiplicity"><doc>This should be a positive integer.</doc></attribute><ref name="optional-user-doc"></ref></element></zeroOrMore><zeroOrMore><element name="product-global-species-ref"><doc>Here, you give the name of a product species, along with its multiplicity (the number of molecules of this species produced in a single reaction event).</doc><attribute name="name"><doc>Give the name of an explicit species.</doc></attribute><attribute name="multiplicity"><doc>This should be a positive integer.</doc></attribute><ref name="optional-user-doc"></ref></element></zeroOrMore><element name="rate"><doc>The units of reaction rate depend on the arity of the reaction.  A unary reaction's rate is expressed in Hz, or equivalently 1/sec.  A binary reaction's rate is expressed in (Hz)(l)/(mol), or Hz/M, where M denotes molar concentration, (mol)/(liter).</doc><attribute name="value"><doc user-variable="yes">This should be a non-negative floating-point number, like 34.5, or 9.1e20, or 0.0.</doc></attribute><ref name="optional-user-doc"></ref></element></element></zeroOrMore></element></element><element name="streams"><doc>The streams section of moleculizer-input is where you control simulation output.</doc><element name="species-streams"><doc>A species stream is a collection of species whose populations are summed for dumping to output.  This is a surprisingly common need; for example, to get the total amount of Ste4 that is bound to Ste5, one has to specify all the species that contain the Ste4-Ste5 subcomplex.  This can be done with an omni-species-stream.</doc><zeroOrMore><ref name="species-streams-content"></ref></zeroOrMore></element><element name="dump-streams"><doc>Each dump-stream specifies the contents of a dump file, which is also usually what ends up in a single plot.  Any dumpable item can be dumped in any number of dump files.</doc><zeroOrMore><element name="dump-stream"><doc>A dump-stream specifies what gets dumped into a particular output file.  Each item (explicit-species, species-stream, or simulator statistic) you specify for dumping becomes a column of figures in the dump file. My usual practice is to plot everything in a dump file on a single plot, and the Gnuplot script "plt" that comes with Moleculizer is designed to do this.</doc><attribute name="dump-period"><doc user-variable="yes">The interval in (simulated) seconds between dumps.  This should be a positive, floating-point number, like 52.0 or 0.05.  Typically, all the dump-streams you specify will have the same dump-period, but it is not required that they do.  You could dump statistics more slowly, for example.</doc></attribute><ref name="optional-user-doc"></ref><choice><element name="target-file"><doc>The name of the dump file.  It is also displayed automatically as the title on a plot produced with "plt" if no other title is demanded.</doc><attribute name="file-name"><doc>Usually, you want dump files to end up in the same directory where the simulation is running, so you just give a simple file name, like "kinase-species".  But you can also use a relative or absolute path, like
"simulation-output/kinase-species" or "/home/jerry/sims/output/saturday/kinase-species".</doc></attribute><ref name="optional-user-doc"></ref></element><element name="target-output-stream"><doc>Use this, instead of a target-file, to dump output to standard output or standard error.  This is not recommended for server-based simulation.</doc><attribute name="name"><doc>There are two possible values: standard-output and standard-error.</doc><choice><value>standard-output</value><value>standard-error</value></choice></attribute><ref name="optional-user-doc"></ref></element></choice><oneOrMore><choice><element name="species-stream-ref"><doc>Here, you point to something defined in the species-streams section to dump as a column of figures (or trace on a plot).</doc><attribute name="name"><doc>The name of a species-stream.</doc></attribute><attribute name="total-pops"><choice><value>yes</value><value>no</value></choice></attribute><ref name="optional-user-doc"></ref><optional><element name="dump-compartments"><doc>Use this element to dump the populations of particular compartments.</doc><ref name="optional-user-doc"></ref><oneOrMore><element name="compartment-ref"><doc>Use one or more of these elements to specify compartments whose population to dump.</doc><attribute name="name"><doc>This must be the name of a compartment.</doc></attribute><ref name="optional-user-doc"></ref></element></oneOrMore></element></optional></element><element name="species-ref"><doc>Here, you point to an explicit-species whose population to dump as a column of figures (or trace on a plot).</doc><attribute name="name"><doc>The name of an explicit-species.</doc></attribute><attribute name="total-pops"><choice><value>yes</value><value>no</value></choice></attribute><ref name="optional-user-doc"></ref><optional><element name="dump-compartments"><doc>Use this element to dump the populations of particular compartments.</doc><oneOrMore><element name="compartment-ref"><doc>Use one or more of these elements to specify compartments whose population to dump.</doc><attribute name="name"><doc>This must be the name of a compartment.</doc></attribute><ref name="optional-user-doc"></ref></element></oneOrMore></element></optional></element><element name="stat-stream-ref"><doc>This is how to dump simulator statistics as columns in a dump file.  Look at the documentation for the name attribute to see a list of the available statistics.</doc><attribute name="name"><doc more-doc-href="stat-stream-ref.html">Please follow the link to More.</doc><choice><value>sim-time</value><value>clock-time</value><value>species-count</value><value>reaction-count</value><value>reaction-event-count</value><value>volume</value></choice></attribute><ref name="optional-user-doc"></ref></element></choice></oneOrMore></element></zeroOrMore></element></element><element name="events"><doc>Moleculizer can be programmed to do specific deeds at specific times, including creating molecules, dumping the state of the simulation, and stopping the simulation.</doc><zeroOrMore><choice><element name="create-event"><doc>Use a create-event to create new molecules during the simulation.  You have to specify a particular species, which must therefore be an explicit-species.  When you define an explicit species, you have an opportunity to say what its initial population is in the definition of the species, so that it is not necessary to create the initial population with a create-event (although you can do so if you wish.)</doc><attribute name="time"><doc user-variable="yes">This should be a non-negative, floating point number of (simulated) seconds,
like 0.0, or 1.0e3.</doc></attribute><ref name="optional-user-doc"></ref><element name="species-ref"><doc>Here, you give the name of the species of the molecules you wish to create.</doc><attribute name="name"><doc>This must be the name of an explicit-species.</doc></attribute><ref name="optional-user-doc"></ref></element><element name="default-compartment-pop"><doc>Give the population that will appear in each compartment.  You can override this default population for any or all compartments.</doc><attribute name="count"><doc>This should be a non-negative integer.</doc></attribute><ref name="optional-user-doc"></ref></element><zeroOrMore><element name="compartment-pop"><doc>Use as many of these OPTIONAL elements to override the default population on a compartment-by-compartment basis.</doc><attribute name="compartment-name"><doc>Give the name of the compartment where the species is to be created.</doc></attribute><attribute name="count"><doc>Give the population that you want to appear in the particular compartment.  This should be a non-negative integer.</doc></attribute><ref name="optional-user-doc"></ref></element></zeroOrMore></element><element name="dump-state-event"><doc>Use a dump-state-event to cause Moleculizer's state to be dumped at a chosen point during a simulation.   The state dump contains all the species and reactions that exist at the time of the dump, along with other data needed to reconstruct the simulation.</doc><attribute name="time"><doc user-variable="yes">This should be a non-negative, floating point number of (simulated) seconds,
like 0.0, or 1.0e3.</doc></attribute><ref name="optional-user-doc"></ref><element name="target-file"><doc>Give the name to the state dump file you wish to create at this time during the simulation.</doc><attribute name="file-name"><doc>This may be an absolute file name (starting with /) or a file name relative to the working directory.</doc></attribute></element></element><element name="stop-event"><doc>A stop-event stops the simulation, so every simulation should probably have one, and only one, of them.</doc><attribute name="time"><doc user-variable="yes">This should be a non-negative, floating point number of (simulated) seconds,
like 0.0, or 1.0e3.</doc></attribute><ref name="optional-user-doc"></ref></element></choice></zeroOrMore></element><element name="run-params"><doc>In this element, you give several parameters connected with the approximations made in compartmentalizer's algorithm.</doc><attribute name="cycle-time"><doc>Time step for diffusion calculation.  This is the largest time step that the diffusion part of the simulation cycle is allowed to take.  In the course of simulation, this time step is usually limited by the total reaction propensity and the target number of reaction events per diffusion step.</doc></attribute><attribute name="reactions-per-cycle"><doc>Give the target number of reactions to happen in a diffusion cycle.  This should be a positive integer, but rather small integers like 1 or 5 are not unreasonable.  The smaller this number is, the better the approximation, but the slower the simulation runs.</doc></attribute><attribute name="epsilon"><doc>This is an error limit used in the diffusion part of the simulation cycle.  It is used to control the degree of approximation in exponentiating the diffusion matrix, and it may require some trial-and-error to get a good value.  Too small, and the matrix exponential goes on forever.  Too large, and the matrix exponential will be inaccurate.  A value like 1.0e-4 is a good place to start.</doc></attribute><ref name="optional-user-doc"></ref></element></element></start></grammar-doc>