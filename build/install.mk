###############################################################################
# Moleculizer - a stochastic simulator for cellular chemistry.
# Copyright (C) 2001  Walter Lawrence (Larry) Lok.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#    
# Contact information:
#   Larry Lok, Research Fellow          Voice: 510-981-8740
#   The Molecular Sciences Institute      Fax: 510-647-0699
#   2168 Shattuck Ave.                  Email: lok@molsci.org
#   Berkeley, CA 94704
###############################################################################

# Directory where we accumulate everything necessary to build user.xmloperator
# in the binary distribution.  One might as well use it in the same way
# in the main build, too.
$(INS) :
	mkdir $@

INS_XMLOPERATOR := $(INS)/standalone-xmloperator

# The skeleton user.xmloperator.  Schemas and xslt transformations are put
# here, so that they need not be touched when user.xmoloperator is generated.
$(INS_XMLOPERATOR) : $(INSTALL)/standalone-xmloperator | $(INS)
	cp -r $< $@

# Code snippets, etc. needed by user-install.mk, possibly in the binary
# release.
$(INS)/misc : $(INSTALL)/misc | $(INS)
	cp -r $< $@

# Target that indicates that $(INS)/standalone-xmloperator is up-to-date
# and ready to get final configuration.  This file, presumably, is actually
# a part of the binary distribution.
$(INS_XMLOPERATOR)/.configurable : $(INS)/standalone-xmloperator
	touch $@

# Binary release has to have everything in user.xmloperator except for the
# stuff coming from misc.
.binary-release-prepared : $(INS_XMLOPERATOR)/.configurable \
	$(INS)/misc
	touch $@

INS_TGT_DIR := $(INS_XMLOPERATOR)/moleculizer

$(INS_TGT_DIR) : | $(INS_XMLOPERATOR)

# Rules to copy schema files into the "staging" .xmloperator/moleculizer/schema
# directory.
# 
# There are also "simplified" schema files in .xmloperator/moleculizer/schema,
# but these are generated by xmloperator from the ordinary .rng schema files.
# Before release, one has to do this GUI-ly in xmloperator, then copy one's
# .xmloperator directory back over install/xmloperator.  Then there is a
# special rule in install-schema.mk to clean install.xmloperator before source
# release, committing to subversion, or whatever.
# 
# This is rather a drag, but the xmloperator folk no longer expose the scripts
# to do "simplification," as far as I can tell.
include $(BUILD)/install-schema.mk

# Rules to copy XLST files into the "staging" .xmloperator/moleculizer/xsl
# directory.
include $(BUILD)/install-xsl.mk

# Rules to generate user.xmloperator.
include $(BUILD)/user-install.mk

PREEN_LIST += $(INSTALL)/*~
